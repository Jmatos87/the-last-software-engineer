import type { CardDef } from '../types';

export const cards: Record<string, CardDef> = {
  console_log: {
    id: 'console_log',
    name: 'Console.log',
    type: 'attack',
    target: 'enemy',
    cost: 1,
    rarity: 'starter',
    description: 'Deal 6 damage.',
    effects: { damage: 6 },
    upgradedEffects: { damage: 9 },
    upgradedDescription: 'Deal 9 damage.',
    icon: 'ðŸ“',
  },
  div_block: {
    id: 'div_block',
    name: 'Div Block',
    type: 'skill',
    target: 'self',
    cost: 1,
    rarity: 'starter',
    description: 'Gain 5 block.',
    effects: { block: 5 },
    upgradedEffects: { block: 8 },
    upgradedDescription: 'Gain 8 block.',
    icon: 'ðŸ›¡ï¸',
  },
  refactor: {
    id: 'refactor',
    name: 'Refactor',
    type: 'skill',
    target: 'self',
    cost: 1,
    rarity: 'starter',
    description: 'Draw 2 cards.',
    effects: { draw: 2 },
    upgradedEffects: { draw: 3 },
    upgradedDescription: 'Draw 3 cards.',
    icon: 'ðŸ”„',
  },
  coffee_break: {
    id: 'coffee_break',
    name: 'Coffee Break',
    type: 'skill',
    target: 'self',
    cost: 1,
    rarity: 'starter',
    description: 'Reduce 6 Stress.',
    effects: { copium: 6 },
    upgradedEffects: { copium: 9 },
    upgradedDescription: 'Reduce 9 Stress.',
    icon: 'â˜•',
  },
  // Common cards
  npm_install: {
    id: 'npm_install',
    name: 'npm install',
    type: 'skill',
    target: 'self',
    cost: 1,
    rarity: 'common',
    description: 'Gain 8 block.',
    effects: { block: 8 },
    upgradedEffects: { block: 11 },
    upgradedDescription: 'Gain 11 block.',
    icon: 'ðŸ“¦',
  },
  stack_overflow: {
    id: 'stack_overflow',
    name: 'Stack Overflow',
    type: 'attack',
    target: 'enemy',
    cost: 1,
    rarity: 'common',
    description: 'Deal 9 damage.',
    effects: { damage: 9 },
    upgradedEffects: { damage: 12 },
    upgradedDescription: 'Deal 12 damage.',
    icon: 'ðŸ“š',
  },
  code_review: {
    id: 'code_review',
    name: 'Code Review',
    type: 'skill',
    target: 'enemy',
    cost: 1,
    rarity: 'common',
    description: 'Apply 2 Vulnerable.',
    effects: { applyToTarget: { vulnerable: 2 } },
    upgradedEffects: { applyToTarget: { vulnerable: 3 } },
    upgradedDescription: 'Apply 3 Vulnerable.',
    icon: 'ðŸ”',
  },
  git_push: {
    id: 'git_push',
    name: 'Git Push',
    type: 'attack',
    target: 'enemy',
    cost: 2,
    rarity: 'common',
    description: 'Deal 10 damage. Draw 1 card.',
    effects: { damage: 10, draw: 1 },
    upgradedEffects: { damage: 14, draw: 1 },
    upgradedDescription: 'Deal 14 damage. Draw 1 card.',
    icon: 'â¬†ï¸',
  },
  rubber_duck: {
    id: 'rubber_duck',
    name: 'Rubber Duck Debug',
    type: 'skill',
    target: 'self',
    cost: 1,
    rarity: 'common',
    description: 'Gain 6 block. Draw 1 card.',
    effects: { block: 6, draw: 1 },
    upgradedEffects: { block: 8, draw: 1 },
    upgradedDescription: 'Gain 8 block. Draw 1 card.',
    icon: 'ðŸ¦†',
  },
  // Uncommon cards
  pair_programming: {
    id: 'pair_programming',
    name: 'Pair Programming',
    type: 'attack',
    target: 'enemy',
    cost: 1,
    rarity: 'uncommon',
    description: 'Deal 6 damage twice.',
    effects: { damage: 6, applyToTarget: {} },
    upgradedEffects: { damage: 8 },
    upgradedDescription: 'Deal 8 damage twice.',
    icon: 'ðŸ‘¥',
  },
  sprint_planning: {
    id: 'sprint_planning',
    name: 'Sprint Planning',
    type: 'skill',
    target: 'self',
    cost: 1,
    rarity: 'uncommon',
    description: 'Gain 1 energy. Draw 1 card.',
    effects: { energy: 1, draw: 1 },
    upgradedEffects: { energy: 1, draw: 2 },
    upgradedDescription: 'Gain 1 energy. Draw 2 cards.',
    icon: 'ðŸ“‹',
  },
  technical_debt: {
    id: 'technical_debt',
    name: 'Technical Debt',
    type: 'attack',
    target: 'all_enemies',
    cost: 1,
    rarity: 'uncommon',
    description: 'Deal 7 damage to ALL enemies.',
    effects: { damageAll: 7 },
    upgradedEffects: { damageAll: 10 },
    upgradedDescription: 'Deal 10 damage to ALL enemies.',
    icon: 'ðŸ’¸',
  },
  firewall: {
    id: 'firewall',
    name: 'Firewall',
    type: 'skill',
    target: 'self',
    cost: 2,
    rarity: 'uncommon',
    description: 'Gain 15 block.',
    effects: { block: 15 },
    upgradedEffects: { block: 20 },
    upgradedDescription: 'Gain 20 block.',
    icon: 'ðŸ”¥',
  },
  agile_methodology: {
    id: 'agile_methodology',
    name: 'Rage Apply',
    type: 'power',
    target: 'self',
    cost: 1,
    rarity: 'uncommon',
    description: 'Gain 2 Rage Apply.',
    effects: { applyToSelf: { strength: 2 } },
    upgradedEffects: { applyToSelf: { strength: 3 } },
    upgradedDescription: 'Gain 3 Rage Apply.',
    icon: 'ðŸ˜¤',
  },
  // Rare cards
  force_push: {
    id: 'force_push',
    name: 'Force Push',
    type: 'attack',
    target: 'enemy',
    cost: 3,
    rarity: 'rare',
    description: 'Deal 30 damage.',
    effects: { damage: 30 },
    upgradedEffects: { damage: 40 },
    upgradedDescription: 'Deal 40 damage.',
    icon: 'ðŸ’¥',
  },
  kubernetes: {
    id: 'kubernetes',
    name: 'Emotional Intelligence',
    type: 'power',
    target: 'self',
    cost: 2,
    rarity: 'rare',
    description: 'Gain 3 Emotional Intelligence.',
    effects: { applyToSelf: { dexterity: 3 } },
    upgradedEffects: { applyToSelf: { dexterity: 4 } },
    upgradedDescription: 'Gain 4 Emotional Intelligence.',
    icon: 'ðŸ§ ',
  },
  full_stack: {
    id: 'full_stack',
    name: 'Full Stack',
    type: 'attack',
    target: 'enemy',
    cost: 2,
    rarity: 'rare',
    description: 'Deal 12 damage. Gain 12 block.',
    effects: { damage: 12, block: 12 },
    upgradedEffects: { damage: 16, block: 16 },
    upgradedDescription: 'Deal 16 damage. Gain 16 block.',
    icon: 'ðŸ—ï¸',
  },
  // Curse
  ghosted_curse: {
    id: 'ghosted_curse',
    name: 'Ghosted',
    type: 'curse',
    target: 'self',
    cost: 1,
    rarity: 'curse',
    description: 'Unplayable. Clogs your hand. They never called back.',
    effects: {},
    icon: 'ðŸ’”',
  },
  // Copium cards
  deep_breath: {
    id: 'deep_breath',
    name: 'Deep Breath',
    type: 'skill',
    target: 'self',
    cost: 1,
    rarity: 'common',
    description: 'Reduce 8 Stress.',
    effects: { copium: 8 },
    upgradedEffects: { copium: 11 },
    upgradedDescription: 'Reduce 11 Stress.',
    icon: 'ðŸŒ¬ï¸',
  },
  meditation: {
    id: 'meditation',
    name: 'Meditation',
    type: 'skill',
    target: 'self',
    cost: 1,
    rarity: 'common',
    description: 'Reduce 6 Stress. Draw 1 card.',
    effects: { copium: 6, draw: 1 },
    upgradedEffects: { copium: 8, draw: 1 },
    upgradedDescription: 'Reduce 8 Stress. Draw 1 card.',
    icon: 'ðŸ§˜',
  },
  therapy_session: {
    id: 'therapy_session',
    name: 'Therapy Session',
    type: 'skill',
    target: 'self',
    cost: 2,
    rarity: 'uncommon',
    description: 'Reduce 15 Stress.',
    effects: { copium: 15 },
    upgradedEffects: { copium: 20 },
    upgradedDescription: 'Reduce 20 Stress.',
    icon: 'ðŸ›‹ï¸',
  },
  work_life_balance: {
    id: 'work_life_balance',
    name: 'Work-Life Balance',
    type: 'skill',
    target: 'self',
    cost: 2,
    rarity: 'uncommon',
    description: 'Gain 10 Block. Reduce 10 Stress.',
    effects: { block: 10, copium: 10 },
    upgradedEffects: { block: 13, copium: 13 },
    upgradedDescription: 'Gain 13 Block. Reduce 13 Stress.',
    icon: 'âš–ï¸',
  },
  // New buff cards
  touch_grass: {
    id: 'touch_grass',
    name: 'Touch Grass',
    type: 'power',
    target: 'self',
    cost: 1,
    rarity: 'common',
    description: 'Gain 3 Touch Grass. Heal 3 HP each turn.',
    effects: { applyToSelf: { regen: 3 } },
    upgradedEffects: { applyToSelf: { regen: 5 } },
    upgradedDescription: 'Gain 5 Touch Grass. Heal 5 HP each turn.',
    icon: 'ðŸŒ¿',
  },
  self_care_routine: {
    id: 'self_care_routine',
    name: 'Self Care Routine',
    type: 'power',
    target: 'self',
    cost: 1,
    rarity: 'uncommon',
    description: 'Gain 2 Self Care. Reduce 2 stress each turn.',
    effects: { applyToSelf: { selfCare: 2 } },
    upgradedEffects: { applyToSelf: { selfCare: 3 } },
    upgradedDescription: 'Gain 3 Self Care. Reduce 3 stress each turn.',
    icon: 'ðŸ›',
  },
  networking_event: {
    id: 'networking_event',
    name: 'Networking Event',
    type: 'power',
    target: 'self',
    cost: 1,
    rarity: 'rare',
    description: 'Gain 1 Networking. Draw 1 extra card each turn.',
    effects: { applyToSelf: { networking: 1 } },
    upgradedEffects: { applyToSelf: { networking: 2 } },
    upgradedDescription: 'Gain 2 Networking. Draw 2 extra cards each turn.',
    icon: 'ðŸ¤',
  },
  emergency_fund: {
    id: 'emergency_fund',
    name: 'Emergency Fund',
    type: 'power',
    target: 'self',
    cost: 2,
    rarity: 'rare',
    description: 'Gain 10 Savings Account. Retain up to 10 block between turns.',
    effects: { applyToSelf: { savingsAccount: 10 } },
    upgradedEffects: { applyToSelf: { savingsAccount: 15 } },
    upgradedDescription: 'Gain 15 Savings Account. Retain up to 15 block between turns.',
    icon: 'ðŸ¦',
  },
  counter_offer: {
    id: 'counter_offer',
    name: 'Counter-Offer',
    type: 'power',
    target: 'self',
    cost: 2,
    rarity: 'uncommon',
    description: 'Gain 3 Counter-Offer. Deal 3 damage back when attacked.',
    effects: { applyToSelf: { counterOffer: 3 } },
    upgradedEffects: { applyToSelf: { counterOffer: 5 } },
    upgradedDescription: 'Gain 5 Counter-Offer. Deal 5 damage back when attacked.',
    icon: 'ðŸ’¼',
  },
  hustle_culture: {
    id: 'hustle_culture',
    name: 'Hustle Culture',
    type: 'power',
    target: 'self',
    cost: 2,
    rarity: 'rare',
    description: 'Gain 1 energy each turn. Gain 3 stress each turn.',
    effects: { applyToSelf: { hustleCulture: 1 } },
    upgradedEffects: { applyToSelf: { hustleCulture: 1 }, energy: 1 },
    upgradedDescription: 'Gain 1 energy. Gain 1 energy each turn. Gain 3 stress each turn.',
    icon: 'ðŸ’ª',
  },
};

export function getCardDef(id: string): CardDef {
  return cards[id];
}

export function getRewardCards(count: number, rarity?: 'common' | 'uncommon' | 'rare'): CardDef[] {
  const pool = Object.values(cards).filter(c => {
    if (c.rarity === 'starter' || c.rarity === 'curse') return false;
    if (rarity) return c.rarity === rarity;
    return true;
  });
  const shuffled = [...pool].sort(() => Math.random() - 0.5);
  return shuffled.slice(0, count);
}
